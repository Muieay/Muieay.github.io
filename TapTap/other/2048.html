<!DOCTYPE html><html><head><link rel="icon" href="/img/favicon.png"><title>2048-game</title><meta charset="utf-8"><style media="screen">#game{display:none;position:absolute;left:0;top:0;right:0;bottom:0;background-color:#9da5c3;opacity:.5;z-index:1}.clear:after{content:"";display:table;clear:both}.left{float:left}.right{float:right}.scoreShow{height:50px;text-align:center;line-height:50px}.model{text-decoration:none;color:#fff;background-color:#bbada0;font-size:36px;border-radius:10px}.head{width:480px;height:50px;margin:0 auto;font-size:25px}#gridPanel{width:480px;height:480px;margin:0 auto;background-color:#bbada0;border-radius:10px;position:relative;z-index:1}.cell,.grid{width:100px;height:100px;border-radius:6px}.grid{background-color:#ccc0b3;float:left;margin:16px 0 0 16px}.cell{position:absolute;font-size:60px;text-align:center;line-height:100px;color:#fff}.n2{background-color:#eee3da}.n4{background-color:#ede0c8}.n8{background-color:#f2b179}.n16{background-color:#f59563}.n32{background-color:#f67c5f}.n64{background-color:#f65e3b}.n128{background-color:#edcf72}.n256{background-color:#edcc61}.n512{background-color:#9c0}.n1024{background-color:#33b5e5}.n2048{background-color:#09c}.n4096{background-color:#a6c}.n8192{background-color:#93c}.n2,.n4{color:#776e65}#gameover{width:100%;display:none;position:fixed;left:50%;right:50%;top:148px;width:220px;height:200px;border-radius:10px;background-color:#fff;margin-left:-110px;text-align:center;z-index:5}#gameover>a{display:inline-block;width:170px;height:50px;border-radius:10px;text-decoration:none;background-color:#9f8d77;color:#fff;font-size:36px}</style></head><body><div id="game"></div><div class="head clear"><div class="scoreShow left"><span>Score:</span><span id="score"></span></div><div class="selction right" onclick="getModel(event)"><a href="#" class="model" value="3">3X3</a> <a href="#" class="model" value="4">4X4</a> <a href="#" class="model" type="button">5X5</a> <a href="#" class="model" type="button">6X6</a></div></div><div id="gridPanel"></div><div id="gameover"><h1 id="Score"></h1><a href="#" id="again" onclick="obj.gameStart()">Try again</a></div><script>var arr=[];function $(r){return document.getElementById(r)}function C(r){return document.getElementsByClassName(r)}var obj={ROW:4,CELL:4,r:0,c:0,f:0,keyCd:0,score:0,createEle:0,eleFragment:"",gameStart:function(){obj.init(),document.onkeydown=function(r){switch(r.keyCode){case 37:obj.keyCd=1,obj.moveLeft();break;case 38:obj.keyCd=2,obj.moveUp();break;case 39:obj.keyCd=1,obj.moveRight();break;case 40:obj.keyCd=2,obj.moveDown()}$("score").innerHTML=obj.score}},init:function(){for(obj.eleFragment=document.createDocumentFragment(),r=0;r<obj.ROW;r++)for(arr.push([]),c=0;c<obj.CELL;c++)arr[r][c]=0,1==obj.createEle&&obj.create(r,c);1==obj.createEle&&(obj.createEle=0,$("gridPanel").innerHTML="",$("gridPanel").appendChild(obj.eleFragment)),obj.score=0,$("score").innerHTML=obj.score,$("game").style.display="none",$("gameover").style.display="none",obj.random(),obj.random(),obj.updateView()},create:function(r,e){var o,a,n,c,t,i,b,l,j=14;o=document.createElement("div"),a=document.createElement("div"),o.id="g"+r+e,o.className="grid",a.id="c"+r+e,a.className="cell",3==obj.ROW?j=24:4==obj.ROW&&(j=18),t=i=(480-(n=c=b=l=66+(6-obj.ROW)*j)*obj.ROW)/(obj.ROW+1),o.style.width=n+"px",o.style.height=c+"px",o.style.marginTop=t+"px",o.style.marginLeft=i+"px",a.style.width=b+"px",a.style.height=l+"px",a.style.top=t+r*(t+b)+"px",a.style.left=i+e*(i+l)+"px",a.style.lineHeight=l+"px",a.style.fontSize=30+10*(6-obj.ROW)+"px",obj.eleFragment.appendChild(o),obj.eleFragment.appendChild(a)},random:function(){for(;;){var r=Math.floor(Math.random()*obj.ROW),e=Math.floor(Math.random()*obj.CELL);if(0==arr[r][e]){arr[r][e]=Math.random()>.5?4:2;break}}},updateView:function(){var e=0;for(r=0;r<obj.ROW;r++)for(c=0;c<obj.CELL;c++)0==arr[r][c]?($("c"+r+c).innerHTML="",$("c"+r+c).className="cell"):($("c"+r+c).innerHTML=arr[r][c],$("c"+r+c).className="cell n"+arr[r][c],(3==obj.ROW&&1024==arr[r][c]||4==obj.ROW&&2048==arr[r][c]||5==obj.ROW&&4096==arr[r][c]||6==obj.ROW&&8192==arr[r][c])&&(e=1));1==e&&($("game").style.display="block",$("gameover").style.display="block",$("Score").innerHTML="You win!<br>Score:"+obj.score),obj.isGameOver()&&($("game").style.display="block",$("gameover").style.display="block",$("Score").innerHTML="GAME OVER!<br>Score:"+obj.score,console.log("gameover"))},isGameOver:function(){for(r=0;r<obj.ROW;r++)for(c=0;c<obj.CELL;c++){if(0==arr[r][c])return!1;if(c!=obj.CELL-1&&arr[r][c]==arr[r][c+1])return!1;if(r!=obj.ROW-1&&arr[r][c]==arr[r+1][c])return!1}return!0},find:function(r,e,o,a,n){if(2==obj.keyCd){if(1==n){for(var c=o;c<a;c+=n)if(0!=arr[c][e])return c}else for(c=o;c>=a;c+=n)if(0!=arr[c][e])return c}else if(1==n){for(c=o;c<a;c+=n)if(0!=arr[r][c])return c}else for(c=o;c>=a;c+=n)if(0!=arr[r][c])return c;return null},dealToLeft:function(r){var e;for(c=0;c<obj.ROW&&null!=(e=obj.find(r,c,c+1,obj.CELL,1));c++)0==arr[r][c]?(arr[r][c]=arr[r][e],arr[r][e]=0,c--):arr[r][c]==arr[r][e]&&(arr[r][c]*=2,arr[r][e]=0,obj.score+=arr[r][c])},move:function(r){var e;e=arr.toString(),r(),e!=arr.toString()&&(obj.random(),obj.updateView())},moveLeft:function(){obj.move(function(){for(r=0;r<obj.ROW;r++)obj.dealToLeft(r)})},dealToRight:function(r){var e;for(c=obj.CELL-1;c>=0&&null!=(e=obj.find(r,c,c-1,0,-1));c--)0==arr[r][c]?(arr[r][c]=arr[r][e],arr[r][e]=0,c++):arr[r][c]==arr[r][e]&&(arr[r][c]*=2,arr[r][e]=0,obj.score+=arr[r][c])},moveRight:function(){obj.move(function(){for(r=0;r<obj.ROW;r++)obj.dealToRight(r)})},dealToUp:function(e){var o;for(r=0;r<obj.ROW&&null!=(o=obj.find(r,e,r+1,obj.ROW,1));r++)0==arr[r][e]?(arr[r][e]=arr[o][e],arr[o][e]=0,r--):arr[r][e]==arr[o][e]&&(arr[r][e]*=2,arr[o][e]=0,obj.score+=arr[r][e])},moveUp:function(){obj.move(function(){for(c=0;c<obj.CELL;c++)obj.dealToUp(c)})},dealToDown:function(e){var o;for(r=obj.ROW-1;r>=0&&null!=(o=obj.find(r,e,r-1,0,-1));r--)0==arr[r][e]?(arr[r][e]=arr[o][e],arr[o][e]=0,r++):arr[r][e]==arr[o][e]&&(arr[r][e]*=2,arr[o][e]=0,obj.score+=arr[r][e])},moveDown:function(){obj.move(function(){for(c=0;c<obj.CELL;c++)obj.dealToDown(c)})}};function getModel(r){var e=r.target,o=4;"A"==e.nodeName&&("3X3"==e.innerHTML?o=3:"4X4"==e.innerHTML?o=4:"5X5"==e.innerHTML?o=5:"6X6"==e.innerHTML&&(o=6),obj.ROW=obj.CELL=o,obj.createEle=1,obj.gameStart())}window.onload=function(){obj.createEle=1,obj.gameStart()}</script></body></html>